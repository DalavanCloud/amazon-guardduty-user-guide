# CreateThreatIntelSet<a name="create-threat-intel-set"></a>

Create a new ThreatIntelSet\. ThreatIntelSets consist of known malicious IP addresses\. GuardDuty generates findings based on ThreatIntelSets\. 

## Request Syntax<a name="create-threat-intel-request-syntax"></a>

```
POST https://<endpoint>/detector/{detectorId}/threatintelset
```

**Body:**

```
{
    "name": "string",
    "location": "string",
    "format": "[TXT|STIX|OTX_CSV|ALIEN_VAULT|PROOF_POINT|FIRE_EYE]",
    "activate": "boolean"
}
```

## Request Parameters<a name="create-threat-intel-request-parameters"></a>

The request accepts the following data in JSON format\.

**detectorId**  
The detectorID that specifies the GuardDuty service for which you want to create a ThreatIntelSet\.   
Type: String  
Required: Yes

**name**  
A user\-friendly ThreatIntelSet name that is displayed in all finding generated by activity that involves IP addresses included in this ThreatIntelSet\.  
Type: String  
Required: Yes

**format**  
The format of the file that contains the ThreatIntelSet\.  
Type: String\. Valid values: TXT | STIX | OTX\_CSV | ALIEN\_VAULT | PROOF\_POINT | FIRE\_EYE  
Required: Yes

**location**  
The URI of the file that contains the ThreatIntelSet\.  
Type: String  
Required: Yes

**activate**  
A boolean value that indicates whether GuardDuty is to start using the created ThreatIntelSet\.   
Type: Boolean  
Required: Yes

## Response Syntax<a name="create-threat-intel-response-syntax"></a>

```
{
    "threatIntelSetId": "string"
}
```

## Response Elements<a name="create-threat-intel-response-parameters"></a>

If the action is successful, the service sends back an HTTP 200 response\.

The following data is returned in JSON format by the service\.

**threatIntelSetId**  
The unique ID that specifies the newly created ThreatIntelSet\.  
Type: String

## Errors<a name="create-threat-intel-errors"></a>

If the action is not successful, the service sends back and HTTP error response code along with detailed error information

**InvalidInputException**

The request is rejected because an invalid or out\-of\-range value is specified as an input parameter\.

HTTP Status Code: 400 

**InvalidInputException**

The request is rejected because required query or path parameters are not specified\.\.

HTTP Status Code: 400 

**InvalidInputException**

The request is rejected because one or more input parameters have invalid values\.

HTTP Status Code: 400 

**InvalidInputException**

The request is rejected because the parameter name has an invalid value\.

HTTP Status Code: 400 

**InvalidInputException**

The request is rejected because the parameter location has an invalid value\.

HTTP Status Code: 400 

**InvalidInputException**

The request is rejected because the parameter format has an invalid value\.

HTTP Status Code: 400 

**InvalidInputException**

The request is rejected because the parameter detectorId has an invalid value\.

HTTP Status Code: 400 

**NoSuchEntityException**

The request is rejected because the input detectorId is not owned by the current account\.

HTTP Status Code: 400 

**AccessDeniedException**

The request is rejected because the caller is not authorized to call this API\.

HTTP Status Code: 400 

**NoSuchEntityException**

The request is rejected because no role was found

HTTP Status Code: 400 

**BadRequestException**

The request is rejected because the service can't assume service role\.

HTTP Status Code: 400 

**AccessDeniedException**

The request was rejected because you do not have the required iam:PutRolePolicy permission\.

HTTP Status Code: 400 

**BadRequestException**

The request was rejected because the specified service role is not a service role\.

HTTP Status Code: 400 

**InternalException**

Internal server error\.

HTTP Status Code: 500 